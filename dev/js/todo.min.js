/*! todo - v0.0.0 - 2014-06-10 */var Todo=window.Todo||{};Todo.Models={},Todo.Collections={},Todo.Views={},Todo.Routers={},Todo.Models.ModelBase=Backbone.Model.extend(),Todo.Models.Todo=Todo.Models.ModelBase.extend({defaults:{text:null,completed:!1},setCompleted:function(){"use strict";this.set("completed",!0),this.save()}}),Todo.Collections.CollectionBase=Backbone.Collection.extend(),Todo.Collections.Todos=Todo.Collections.CollectionBase.extend({model:Todo.Models.Todo,localStorage:new Backbone.LocalStorage("todos-backbone"),getAll:function(){"use strict";return this.models},getActive:function(){"use strict";return this.filter(function(a){return!a.get("completed")})},getCompleted:function(){"use strict";return this.filter(function(a){return a.get("completed")})}}),Todo.Views.ViewBase=Backbone.View.extend(),Todo.Views.TodoForm=Todo.Views.ViewBase.extend({initialize:function(){"use strict";this.$input=this.$('input[type="text"]')},events:{submit:"onSubmit"},onSubmit:function(a){"use strict";a.preventDefault(),this.$input.val()&&(this.collection.add(new Todo.Models.Todo({text:this.$input.val()})),this.$input.val(""),this.$input.focus())}}),Todo.Views.TodoList=Todo.Views.ViewBase.extend({initialize:function(){"use strict";this.listenTo(this.collection,"add",this.add),this.listenTo(this.collection,"reset",this.showAll),this.collection.fetch()},add:function(a){"use strict";a.save();var b=new Todo.Views.TodoListItem({model:a});this.$el.append(b.el)},showAll:function(){"use strict";this.$el.empty(),this.addItems(this.collection.getAll())},showActive:function(){"use strict";this.$el.empty(),this.addItems(this.collection.getActive())},showCompleted:function(){"use strict";this.$el.empty(),this.addItems(this.collection.getCompleted()),console.log("showCompleted")},addItems:function(a){"use strict";for(var b=0;b<a.length;b++)this.add(a[b])}}),Todo.Views.TodoListItem=Todo.Views.ViewBase.extend({tagName:"li",className:"todoListItem",tmpl:'<p><input type="checkbox" class="todoListItem__checkbox"><span class="todoListItem__text"><%= text %></span><a href="#" class="todoListItem__deleteButton">delete</a></p>',events:{"change .todoListItem__checkbox":"onChangeCheckbox","mouseover p":"onMouseover","mouseout p":"onMouseout","click .deleteButton":"onClick"},initialize:function(a){"use strict";this.model=a.model,this.render(),this.listenTo(this.model,"destroy",this.remove)},render:function(){"use strict";var a=_.template(this.tmpl,this.model.toJSON());this.$el.html(a),this.model.get("completed")&&this.setCompleted(this.$(".todoListItem__checkbox"))},onChangeCheckbox:function(a){"use strict";this.setCompleted(a.target)},onMouseover:function(a){"use strict";$(a.target).children(".todoListItem__deleteButton").addClass("todoListItem__deleteButton--show")},onMouseout:function(a){"use strict";$(a.target).children(".todoListItem__deleteButton").removeClass("todoListItem__deleteButton--show")},onClick:function(){"use strict";this.model.destroy()},setCompleted:function(a){"use strict";this.model.setCompleted(),$(a).prop("disabled",!0),$(a).prop("checked",!0),this.$el.addClass("todoListItem--completed")}}),Todo.Routers.RouterBase=Backbone.Router.extend(),Todo.Routers.TodoRouter=Todo.Routers.RouterBase.extend({initialize:function(a){"use strict";this.listView=a.view,this.collection=a.collection},routes:{active:"active",completed:"completed",all:"all"},all:function(){"use strict";this.listView.showAll()},active:function(){"use strict";this.listView.showActive()},completed:function(){"use strict";this.listView.showCompleted()}});var todos=new Todo.Collections.Todos,todoForm=new Todo.Views.TodoForm({el:".todoForm",collection:todos}),todoList=new Todo.Views.TodoList({el:".todoList",collection:todos}),todoRouter=new Todo.Routers.TodoRouter({view:todoList,collection:todos});Backbone.history.start();